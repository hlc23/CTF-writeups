# keygenme-py
## Problem
> [keygenme-trial.py](https://mercury.picoctf.net/static/a6d9cac3bfa4935ceb50c145d3ff5586/keygenme-trial.py)

[link](https://play.picoctf.org/practice/challenge/121)
### Source
[keygenme-trial.py](./keygenme-trial.py)
## Solution
1. download the file `keygenme-trial.py`
2. acroding to the source code we can see the code in `enter_license` function.  
    This function will get the user input and check it with `check_key` function.  
    ```py
    def enter_license():
    user_key = input("\nEnter your license key: ")
    user_key = user_key.strip()

    global bUsername_trial
    
    if check_key(user_key, bUsername_trial):
        decrypt_full_version(user_key)
    else:
        print("\nKey is NOT VALID. Check your data entry.\n\n")
    ```
3. In the `check_key` function we can know the length of key equals `key_full_template_trial`
    ```py
    if len(key) != len(key_full_template_trial):
        return False
    ```
    and from index 0 to 8 will equals to `hashlib.sha256(username_trial).hexdigest(i) for i in [4, 5, 3, 6, 2, 7]`
    ```py
    if key[i] != hashlib.sha256(username_trial).hexdigest()[X]:
            return False
        else:
            i += 1
    ```
4. so the flag will be the output of the following code
    ```py
    key_part_static1_trial = "picoCTF{1n_7h3_|<3y_of_"
    key_part_static2_trial = "}"
    bUsername_trial = b"PRITCHARD"
    print(key_part_static1_trial + "".join([hashlib.sha256(bUsername_trial).hexdigest()[i] for i in [4, 5, 3, 6, 2, 7, 1, 8]]) + key_part_static2_trial)
    ```
## flag
`picoCTF{1n_7h3_|<3y_of_54ef6292}`